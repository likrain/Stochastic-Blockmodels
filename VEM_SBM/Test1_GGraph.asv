clear all
tic;
Alpha = [0.6,0.4];
PI=[0.5,0.05;0.05,0.5];
n =100;
Distribution = 'Bernoulli';
NetType = 'undirected';
[A, Glabel,Z] = GGraph(n,Alpha,PI,Distribution,NetType);

Q = length(Alpha);
[PI, Alpha, Tau, CluResult,time] = vem_sbm(A, Q, Distribution,300,'spectral', NetType);

%CER
cer = CER(Glabel,CluResult);

%Draw
GEindex1 = find(Est_Glabel==1);
GEindex2 = find(Est_Glabel==2);
GEindex = [GEindex1; GEindex2];
imshow(A(GEindex,GEindex));
toc;
